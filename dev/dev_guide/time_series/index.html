<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Time Series Data · InfrastructureSystems.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">InfrastructureSystems.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Welcome Page</a></li><li><span class="tocitem">Developer Guide</span><ul><li><a class="tocitem" href="../components_and_container/">Managing Components</a></li><li><a class="tocitem" href="../auto_generation/">Auto-Generation of Component Structs</a></li><li class="is-active"><a class="tocitem" href>Time Series Data</a><ul class="internal"><li><a class="tocitem" href="#Instructions"><span>Instructions</span></a></li><li><a class="tocitem" href="#Data-Format"><span>Data Format</span></a></li><li><a class="tocitem" href="#Debugging"><span>Debugging</span></a></li><li><a class="tocitem" href="#Maintenance"><span>Maintenance</span></a></li></ul></li><li><a class="tocitem" href="../recorder/">Recorder Events</a></li><li><a class="tocitem" href="../tests/">Running Tests</a></li><li><a class="tocitem" href="../logging/">Logging</a></li></ul></li><li><a class="tocitem" href="../../style/">Style Guide</a></li><li><a class="tocitem" href="../../InfrastructureSystems/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Developer Guide</a></li><li class="is-active"><a href>Time Series Data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Time Series Data</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/NREL-SIIP/InfrastructureSystems.jl/blob/master/docs/src/dev_guide/time_series.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Time-Series-Data"><a class="docs-heading-anchor" href="#Time-Series-Data">Time Series Data</a><a id="Time-Series-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Series-Data" title="Permalink"></a></h1><p><code>InfrastructureSystems.jl</code> implements containers and routines to efficiently manage time series data. This document contains content for developers of new time series data. For the usage please refer to the documentation in <a href="https://nrel-siip.github.io/PowerSystems.jl/stable">PowerSystems.jl</a>.</p><p><code>InfrastructureSystems.jl</code> provides a mechanism to store time series data for components. Here are reasons to consider using it:</p><ul><li>Time series data, by default, is stored independently of components in HDF5 files. Components store references to that data.</li><li>System memory is not depleted by loading all time series data at once. Only data that you need is loaded.</li><li>Multiple components can share the same time series data by sharing references instead of making expensive copies.</li><li>Supports serialization and deserialization.</li><li>Supports parsing raw data files of several formats as well as data stored in <code>TimeSeries.TimeArray</code> and <code>DataFrames.DataFrame</code> objects.</li></ul><blockquote><p><strong>Your package must reimplement a deepcopy method if you use HDF5 storage for TimeSeriesData.</strong></p></blockquote><p>If you store an instance of <a href="../../InfrastructureSystems/#InfrastructureSystems.SystemData"><code>InfrastructureSystems.SystemData</code></a> within your system and then a user calls <code>deepcopy</code> on a system, the .h5 file will not be copied. The new and old instances will have references to the same file. You will need to reimplement <code>deepcopy</code> to handle this. One solution is to serialize and then deserialize the system.</p><p><em>Notes</em>:</p><ul><li>Time series data can optionally be stored fully in memory. Refer to the <a href="../../InfrastructureSystems/#InfrastructureSystems.SystemData"><code>InfrastructureSystems.SystemData</code></a> documentation.</li><li><code>InfrastructureSystems.jl</code> creates HDF5 files on the tmp filesystem by default, using the location obtained from <code>tempdir()</code>. This can be changed if the time series data is larger than the amount of tmp space available. Refer to the <a href="../../InfrastructureSystems/#InfrastructureSystems.SystemData"><code>InfrastructureSystems.SystemData</code></a> link above.</li></ul><h2 id="Instructions"><a class="docs-heading-anchor" href="#Instructions">Instructions</a><a id="Instructions-1"></a><a class="docs-heading-anchor-permalink" href="#Instructions" title="Permalink"></a></h2><ol><li>Add an instance of <code>InfrastructureSystems.TimeSeriesContainer</code> to the component struct.</li><li>Implement the method <code>InfrastructureSystems.get_time_series_container</code> for the component. It must return the <code>TimeSeriesContainer</code> object.</li></ol><h2 id="Data-Format"><a class="docs-heading-anchor" href="#Data-Format">Data Format</a><a id="Data-Format-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Format" title="Permalink"></a></h2><p>Time series arrays are stored in an <a href="https://support.hdfgroup.org/HDF5/whatishdf5.html">HDF5</a> file according the format described here.</p><p>The root path <code>/time_series</code> defines these HDF5 attributes to control deserialization:</p><ul><li><code>data_format_version</code>: Designates the InfrastructureSystems format for the file.</li><li><code>compression_enabled</code>: Specifies whether compression is enabled and will be used for new time series.</li><li><code>compression_type</code>: Specifies the type of compression being used.</li><li><code>compression_level</code>: Specifies the level of compression being used.</li><li><code>compression_shuffle</code>: Specifies whether the shuffle filter is being used.</li></ul><p>Each time series array is stored in an HDF5 group named with the array&#39;s UUID. Each group contains a dataset called <code>data</code> which contains the actual data. Each group also contains a group called <code>component_references</code> which contains an HDF5 attribute for each component reference. The component reference uses the format <code>&lt;component_uuid&gt;__&lt;time_series_name&gt;</code>.</p><p>Each time series group defines attributes that control how the data will be deserialized into a <code>TimeSeriesData</code> instance.</p><ul><li><code>initial_timestamp</code>: Defines the first timestamp of the array. (All times are not stored.)</li><li><code>resolution</code>: Resolution of the time series in milliseconds.</li><li><code>type</code>: Type of the time series. Subtype of <code>TimeSeriesData</code>.</li><li><code>module</code>: Module that defines the type of the time series.</li><li><code>data_type</code>: Describes the type of the array stored.</li></ul><p>Example:</p><pre><code class="language-none">/time_series
    data_format_version = &quot;1.0.1&quot;
    compression_enabled = 1
    /9f02f706-3394-4af3-8084-8903d302cbba
        /component_references
            0b6ecb61-8e8d-4563-b795-f001246c3ea5__max_active_power
            613ddbc2-b666-4c9d-adb5-fa69e7f40a95__max_active_power
        /data</code></pre><h2 id="Debugging"><a class="docs-heading-anchor" href="#Debugging">Debugging</a><a id="Debugging-1"></a><a class="docs-heading-anchor-permalink" href="#Debugging" title="Permalink"></a></h2><p>The HDF Group provides tools to inspect and manipulate files. Refer to their <a href="https://support.hdfgroup.org/products/hdf5_tools/">website</a>.</p><p><code>HDFView</code> is especially useful for viewing data. Note that using <code>h5ls</code> and <code>h5dump</code> in a terminal combined with UNIX tools like <code>grep</code> can sometimes be faster.</p><h2 id="Maintenance"><a class="docs-heading-anchor" href="#Maintenance">Maintenance</a><a id="Maintenance-1"></a><a class="docs-heading-anchor-permalink" href="#Maintenance" title="Permalink"></a></h2><p>If you delete time series arrays in your system you may notice that the actual size of the HDF5 does not decrease. The only way to recover this space is to build a new file with only the active objects. The HDF5 tools package provides the tool <code>h5repack</code> for this purpose.</p><pre><code class="language-bash">$ h5repack time_series.h5 new.h5
$ mv new.h5 time_series.h5</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../auto_generation/">« Auto-Generation of Component Structs</a><a class="docs-footer-nextpage" href="../recorder/">Recorder Events »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 1 February 2023 20:08">Wednesday 1 February 2023</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
