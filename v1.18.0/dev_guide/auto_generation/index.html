<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Auto-Generation of Component Structs · InfrastructureSystems.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">InfrastructureSystems.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Welcome Page</a></li><li><span class="tocitem">Developer Guide</span><ul><li><a class="tocitem" href="../components_and_container/">Managing Components</a></li><li class="is-active"><a class="tocitem" href>Auto-Generation of Component Structs</a><ul class="internal"><li><a class="tocitem" href="#Instructions"><span>Instructions</span></a></li><li><a class="tocitem" href="#Struct-Descriptor-Rules"><span>Struct Descriptor Rules</span></a></li></ul></li><li><a class="tocitem" href="../time_series/">Time Series Data</a></li><li><a class="tocitem" href="../recorder/">Recorder Events</a></li><li><a class="tocitem" href="../tests/">Running Tests</a></li><li><a class="tocitem" href="../logging/">Logging</a></li></ul></li><li><a class="tocitem" href="../../style/">Style Guide</a></li><li><a class="tocitem" href="../../InfrastructureSystems/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Developer Guide</a></li><li class="is-active"><a href>Auto-Generation of Component Structs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Auto-Generation of Component Structs</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/NREL-SIIP/InfrastructureSystems.jl/blob/master/docs/src/dev_guide/auto_generation.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Auto-Generation-of-Component-Structs"><a class="docs-heading-anchor" href="#Auto-Generation-of-Component-Structs">Auto-Generation of Component Structs</a><a id="Auto-Generation-of-Component-Structs-1"></a><a class="docs-heading-anchor-permalink" href="#Auto-Generation-of-Component-Structs" title="Permalink"></a></h1><p><code>InfrastructureSystems.jl</code> provides a mechanism to auto-generate Julia files containing structs and field accessor functions from JSON descriptors. Here are reasons to consider using this approach:</p><ul><li>Auto-generation allows for easy refactoring of code. Adding fields to many structs can be tedious because you might have to edit many constructors. This process eliminates boiler-plate edits.</li><li>The JSON descriptor format includes a mechanism to define range validation on component fields. Validation can be enabled when adding components to a system.</li><li>Provides consistent formatting of structs, fields, and constructors.</li><li>Provides consistent documentation of structs and fields.</li></ul><h2 id="Instructions"><a class="docs-heading-anchor" href="#Instructions">Instructions</a><a id="Instructions-1"></a><a class="docs-heading-anchor-permalink" href="#Instructions" title="Permalink"></a></h2><p>Refer to the docstrings for <code>generate_struct</code> and <code>generate_structs</code> and generate the files from the REPL.</p><p>Or</p><ol><li>Create or modify the JSON descriptor file. Follow the <a href="https://github.com/NREL-SIIP/PowerSystems.jl/blob/master/src/descriptors/power_system_structs.json">PowerSystems.jl</a> example.</li><li>Run the generation script, passing your descriptor file and an output directory.</li></ol><pre><code class="language-julia">InfrastructureSystems.generate_structs(&quot;./src/descriptors/power_system_structs.json&quot;, &quot;./src/models/generated&quot;)</code></pre><h2 id="Struct-Descriptor-Rules"><a class="docs-heading-anchor" href="#Struct-Descriptor-Rules">Struct Descriptor Rules</a><a id="Struct-Descriptor-Rules-1"></a><a class="docs-heading-anchor-permalink" href="#Struct-Descriptor-Rules" title="Permalink"></a></h2><p>Each struct descriptor must define the following fields:</p><ul><li><code>struct_name</code>: Name of struct</li><li><code>docstring</code>: The docstring of the struct</li><li><code>fields</code>: Array of struct members. See below for requirements.</li><li><code>supertype</code>: Declare the struct with this parent type.</li></ul><p>Required fields for each struct member:</p><ul><li><code>name</code>: Name of field</li><li><code>data_type</code>: Type of field</li></ul><p>Optional fields for each struct member:</p><ul><li><p><code>accessor_module</code>: Set this if the getter/setter functions are reimplementing a method defined in a different module.</p></li><li><p><code>comment</code>: Field comment</p></li><li><p><code>default</code>: The constructors will define this as a default value.</p></li><li><p><code>exclude_setter</code>: Do not generate a setter function for this field.</p></li><li><p><code>internal_default</code>: Set to true for non-user-facing fields like <code>InfrastructureSystemsInternal</code> that have default values.</p></li><li><p><code>needs_conversion</code>: Set to true if the getter and setter function needs to apply unit conversion. The type must implement</p><ul><li><code>get_value(::InfrastructureSystemsComponent, ::Type)</code> and</li><li><code>set_value(::InfrastructureSystemsComponent, ::Type)</code> for this combination of component type and member type.</li></ul></li><li><p><code>null_value</code>: Value to indicate the value is null, such as 0.0 for floating point numbers. If all members in the struct define this field then a &quot;demo&quot; constructor will be generated. This allows you to enter <code>val = MyType(nothing)</code> in the REPL and see the layout of a struct without worrying about valid values.</p></li><li><p><code>valid_range</code>: Define this as a Dict with <code>min</code> and <code>max</code> and <code>InfrastructureSystems.jl</code> will validate any value against that range when you add the component to the system. Use <code>null</code> if one doesn&#39;t apply, such as if there is no max limit.</p></li><li><p><code>validation_action</code>: Define this as <code>error</code> or <code>warn</code>. If it is <code>error</code> then <code>InfrastructureSystems.jl</code> will raise an exception if the validation code detects a problem. Otherwise, it will log a warning.</p></li></ul><p><em>Notes</em>:</p><ul><li>You will need to decide how to manage the generated files. The SIIP packages keep the generated code in the git repository. This is not required. You could choose to generate them at startup.</li><li>You may need to create custom constructors and this approach will not allow you to put them in the same file as the struct definition.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../components_and_container/">« Managing Components</a><a class="docs-footer-nextpage" href="../time_series/">Time Series Data »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 30 September 2022 16:30">Friday 30 September 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
